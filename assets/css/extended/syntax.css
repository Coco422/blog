/* Code Block Styling & Animation */

/* -----------------------------------------------------------------
   1. Collapsible Animation
   ----------------------------------------------------------------- */
details.code-details {
    background: var(--code-block-bg);
    border-radius: var(--radius);
    margin-bottom: var(--gap);
    overflow: hidden;
    border: 1px solid var(--border);
}

details.code-details > summary {
    cursor: pointer;
    padding: 8px 12px;
    background: var(--code-bg);
    border-bottom: 1px solid var(--border);
    list-style: none;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-family: var(--font-mono);
    font-size: 14px;
    color: var(--primary);
    font-weight: 500;
    user-select: none;
    transition: background 0.2s;
}

details.code-details > summary:hover {
    background: var(--entry);
}

details.code-details > summary::-webkit-details-marker {
    display: none;
}

details.code-details > summary::after {
    content: '+';
    display: inline-block;
    width: 16px;
    height: 16px;
    line-height: 16px;
    text-align: center;
    margin-left: 8px;
    transition: transform 0.3s ease;
    font-weight: bold;
}

details.code-details[open] > summary::after {
    transform: rotate(45deg);
}

/* 
   Animation Trick:
   We can't animate height: auto directly.
   We'll use max-height on the inner content.
   Note: This requires the inner content to be wrapped.
*/
details.code-details .collapsible-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0, 1, 0, 1);
}

details.code-details[open] .collapsible-content {
    max-height: 3000px; /* Enough for most code blocks */
    transition: max-height 0.4s ease-in-out;
}

/* -----------------------------------------------------------------
   2. Syntax Highlighting (Light Mode - GitHub Style)
   ----------------------------------------------------------------- */
:root {
    --chroma-bg: #ffffff;
    --chroma-color: #24292e;
    --chroma-err: #b31d28;
    --chroma-line-hl: #e1e4e8;
    --chroma-line-num: #959da5;
    --chroma-k: #d73a49; /* Keyword */
    --chroma-kc: #005cc5; /* Keyword Constant */
    --chroma-kd: #d73a49; /* Keyword Declaration */
    --chroma-kn: #d73a49; /* Keyword Namespace */
    --chroma-kp: #d73a49; /* Keyword Pseudo */
    --chroma-kr: #d73a49; /* Keyword Reserved */
    --chroma-kt: #d73a49; /* Keyword Type */
    --chroma-na: #6f42c1; /* Name Attribute */
    --chroma-nc: #6f42c1; /* Name Class */
    --chroma-no: #005cc5; /* Name Constant */
    --chroma-ne: #6f42c1; /* Name Exception */
    --chroma-nf: #6f42c1; /* Name Function */
    --chroma-nl: #005cc5; /* Name Label */
    --chroma-nn: #6f42c1; /* Name Namespace */
    --chroma-nt: #22863a; /* Name Tag */
    --chroma-nv: #005cc5; /* Name Variable */
    --chroma-s: #032f62;  /* Literal String */
    --chroma-s2: #032f62; /* Literal String Double */
    --chroma-sa: #032f62; /* Literal String Affix */
    --chroma-sb: #032f62; /* Literal String Backtick */
    --chroma-sc: #032f62; /* Literal String Char */
    --chroma-sd: #032f62; /* Literal String Doc */
    --chroma-se: #032f62; /* Literal String Escape */
    --chroma-sh: #032f62; /* Literal String Heredoc */
    --chroma-si: #032f62; /* Literal String Interpol */
    --chroma-sx: #032f62; /* Literal String Other */
    --chroma-sr: #032f62; /* Literal String Regex */
    --chroma-s1: #032f62; /* Literal String Single */
    --chroma-ss: #032f62; /* Literal String Symbol */
    --chroma-m: #005cc5;  /* Literal Number */
    --chroma-o: #d73a49;  /* Operator */
    --chroma-ow: #d73a49; /* Operator Word */
    --chroma-c: #6a737d;  /* Comment */
    --chroma-cm: #6a737d; /* Comment Multiline */
    --chroma-c1: #6a737d; /* Comment Single */
    --chroma-cs: #6a737d; /* Comment Special */
    --chroma-cp: #d73a49; /* Comment Preproc */
    --chroma-gd: #b31d28; /* Generic Deleted */
    --chroma-gi: #22863a; /* Generic Inserted */
    --chroma-gu: #735c0f; /* Generic Subheading */
}

/* -----------------------------------------------------------------
   3. Syntax Highlighting (Dark Mode - Dracula Style)
   ----------------------------------------------------------------- */
.dark {
    --chroma-bg: #282a36;
    --chroma-color: #f8f8f2;
    --chroma-err: #ff5555;
    --chroma-line-hl: #44475a;
    --chroma-line-num: #6272a4;
    --chroma-k: #ff79c6;
    --chroma-kc: #ff79c6;
    --chroma-kd: #8be9fd;
    --chroma-kn: #ff79c6;
    --chroma-kp: #ff79c6;
    --chroma-kr: #ff79c6;
    --chroma-kt: #8be9fd;
    --chroma-na: #50fa7b;
    --chroma-nc: #50fa7b;
    --chroma-no: #bd93f9;
    --chroma-ne: #50fa7b;
    --chroma-nf: #50fa7b;
    --chroma-nl: #8be9fd;
    --chroma-nn: #50fa7b;
    --chroma-nt: #ff79c6;
    --chroma-nv: #8be9fd;
    --chroma-s: #f1fa8c;
    --chroma-s2: #f1fa8c;
    --chroma-sa: #f1fa8c;
    --chroma-sb: #f1fa8c;
    --chroma-sc: #f1fa8c;
    --chroma-sd: #f1fa8c;
    --chroma-se: #f1fa8c;
    --chroma-sh: #f1fa8c;
    --chroma-si: #f1fa8c;
    --chroma-sx: #f1fa8c;
    --chroma-sr: #f1fa8c;
    --chroma-s1: #f1fa8c;
    --chroma-ss: #f1fa8c;
    --chroma-m: #bd93f9;
    --chroma-o: #ff79c6;
    --chroma-ow: #ff79c6;
    --chroma-c: #6272a4;
    --chroma-cm: #6272a4;
    --chroma-c1: #6272a4;
    --chroma-cs: #6272a4;
    --chroma-cp: #ff79c6;
    --chroma-gd: #ff5555;
    --chroma-gi: #50fa7b;
    --chroma-gu: #8be9fd;
}

/* -----------------------------------------------------------------
   4. Apply Variables to Chroma Classes
   ----------------------------------------------------------------- */

/* Background & Basic Text */
.chroma { 
    color: var(--chroma-color) !important; 
    background-color: var(--chroma-bg) !important; 
    border-radius: var(--radius);
    /* Override padding if needed, usually handled by .highlight */
}

/* Error */
.chroma .err { color: var(--chroma-err) !important }
/* Line Table */
.chroma .lntd { vertical-align: top; padding: 0; margin: 0; border: 0; }
.chroma .lntable { border-spacing: 0; padding: 0; margin: 0; border: 0; width: 100%; display: block; }
/* Line Highlight */
.chroma .hl { background-color: var(--chroma-line-hl) !important; display: block; width: 100%; }
/* Line Numbers */
.chroma .lnt, .chroma .ln { color: var(--chroma-line-num) !important; margin-right: 0.5em; padding-right: 0.5em; user-select: none; }

/* Keywords */
.chroma .k { color: var(--chroma-k) !important; font-weight: bold; }
.chroma .kc { color: var(--chroma-kc) !important; font-weight: bold; }
.chroma .kd { color: var(--chroma-kd) !important; font-weight: bold; }
.chroma .kn { color: var(--chroma-kn) !important; font-weight: bold; }
.chroma .kp { color: var(--chroma-kp) !important; font-weight: bold; }
.chroma .kr { color: var(--chroma-kr) !important; font-weight: bold; }
.chroma .kt { color: var(--chroma-kt) !important; font-weight: bold; }

/* Names */
.chroma .na { color: var(--chroma-na) !important }
.chroma .nc { color: var(--chroma-nc) !important; font-weight: bold; }
.chroma .no { color: var(--chroma-no) !important }
.chroma .ne { color: var(--chroma-ne) !important; font-weight: bold; }
.chroma .nf { color: var(--chroma-nf) !important; font-weight: bold; }
.chroma .nl { color: var(--chroma-nl) !important; font-weight: bold; }
.chroma .nn { color: var(--chroma-nn) !important; font-weight: bold; }
.chroma .nt { color: var(--chroma-nt) !important; color: #22863a !important; } /* Tags green in github */
.chroma .nv { color: var(--chroma-nv) !important }

/* Strings */
.chroma .s, .chroma .s2, .chroma .sa, .chroma .sb, .chroma .sc, .chroma .sd, .chroma .se, .chroma .sh, .chroma .si, .chroma .sx, .chroma .sr, .chroma .s1, .chroma .ss { 
    color: var(--chroma-s) !important; 
}

/* Literals */
.chroma .m, .chroma .mb, .chroma .mf, .chroma .mh, .chroma .mi, .chroma .il, .chroma .mo { 
    color: var(--chroma-m) !important; 
}

/* Operators */
.chroma .o, .chroma .ow { color: var(--chroma-o) !important; font-weight: bold; }

/* Comments */
.chroma .c, .chroma .cm, .chroma .c1, .chroma .cs, .chroma .ch { 
    color: var(--chroma-c) !important; 
    font-style: italic; 
}
.chroma .cp { color: var(--chroma-cp) !important; font-weight: bold; }

/* Generics */
.chroma .gd { color: var(--chroma-gd) !important; background-color: #ffeef0; }
.chroma .gi { color: var(--chroma-gi) !important; background-color: #f0fff4; }
.chroma .gu { color: var(--chroma-gu) !important; font-weight: bold; }

/* Dark Mode Specific Overrides for Backgrounds in diffs */
.dark .chroma .gd { background-color: #4b1818; }
.dark .chroma .gi { background-color: #1e3a23; }

/* Ensure full width code blocks */
.highlight {
    width: 100%;
    background-color: var(--chroma-bg) !important;
    border-radius: var(--radius);
    overflow-x: auto;
}

/* Fix for PaperMod code block padding */
.post-content .highlight {
    margin: 0;
}

